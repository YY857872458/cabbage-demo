<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../styles/desc-diff.css">
</head>
<body>
<!--<div id="diffDesc" class="content"></div>-->
<script src="https://p.trellocdn.com/power-up.min.js" crossorigin="anonymous"></script>
<!--<script src="../js/lastDescDiff.js"></script>-->
</body>
<pre id="display"></pre>
<script>
    let color = '';
    const t = window.TrelloPowerUp.iframe();
    const context = t.getContext();
    let span = null;
    t.get(context.card,'shared','diff').then(function (diff) {
        console.log('diff in html',diff);
        const display = document.getElementById('display');
        const fragment = document.createDocumentFragment();

        diff.forEach((part) => {
            // green for additions, red for deletions
            // grey for common parts
            // const color = part.added ? 'green' :
            //     part.removed ? 'red' : '#172b4d';
            // span = document.createElement('span');
            // span.style.color = color;
            // span.appendChild(document
            //     .createTextNode(part.value));
            // fragment.appendChild(span);
            if(part.added){
                color = 'green';
                span = document.createElement('ins');
            }else if(part.removed){
                color = 'red';
                span = document.createElement('del');
            }else {
                color = '#172b4d'
                span = document.createElement('span');
            }
            span.style.color = color;
            span.appendChild(document
                .createTextNode(part.value));
            fragment.appendChild(span);
        });
        display.appendChild(fragment);
    })
</script>
</html>
