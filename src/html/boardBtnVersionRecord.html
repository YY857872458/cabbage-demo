<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../styles/desc-diff.css">
</head>
<script src="https://p.trellocdn.com/power-up.min.js" crossorigin="anonymous"></script>
<body>
<table class="table" id="table" border="1">
    <caption>Story List</caption>
    <tr>
        <th>Label</th>
        <th>Title</th>
        <th>Last Time</th>
        <th>Version Record</th>
    </tr>
    <tr>
        <td>January</td>
        <td>$100</td>
        <td>$100</td>
        <td>$100</td>
    </tr>
    <tr>
        <td>February</td>
        <td>$50</td>
        <td>$50</td>
        <td>$50</td>
    </tr>
</table>
<script>
    // let color = '';
    const t = window.TrelloPowerUp.iframe();
    const context = t.getContext();
    let tr = null;
    let labelTd = null;
    let titleTd = null;
    let lastTimeTd = null;
    let versionRecordTd = null;

    const cardsVersionRecordInfo = t.arg('cardsVersionRecordInfo');
    console.log("cardsVersionRecordInfo in html: ", cardsVersionRecordInfo);

    const table = document.getElementById('table');
    const fragment = document.createDocumentFragment();

    cardsVersionRecordInfo.forEach((card) => {
        tr = document.createElement('tr');
        card.labels.filter(label => label.name !== '');
        console.log('card labels after filter: ', card.labels);

        labelTd = document.createElement('td');
        labelTd.appendChild(document.createTextNode(card.labels));
        tr.appendChild(labelTd);

        titleTd = document.createElement('td');
        titleTd.appendChild(document.createTextNode(card.name));
        tr.appendChild(titleTd);

        lastTimeTd = document.createElement('td');
        lastTimeTd.appendChild(document.createTextNode(card.lastTime));
        tr.appendChild(lastTimeTd);

        versionRecordTd = document.createElement('td');
        versionRecordTd.appendChild(document.createTextNode(card.versionList));
        tr.appendChild(versionRecordTd);

        fragment.appendChild(tr);
    });
    table.appendChild(fragment);

</script>
</body>
</html>
